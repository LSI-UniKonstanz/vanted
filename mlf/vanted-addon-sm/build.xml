<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jar" name="Create Stress Minimization Add-on Jar file for VANTED">

	<!-- Note: A built VANTED fat jar must be available at '../VANTED/target/jar'! -->

	<property name="jar.dest.path" value="target/jar" />
	<property name="target.name" value="Add-on-Stress-Minimization.jar" />

	<target name="create_run_jar" depends="compile">
		<!-- This can be used to keep all old versions of your Add-on instead of 
			overwriting -->
		<tstamp>
			<format property="date" pattern="yy-MM-dd" locale="en" />
		</tstamp>
		<delete file="${jar.dest.path}/${target.name}.jar" />
		<!-- put sources and classes into the jar -->

		<jar destfile="${jar.dest.path}/dependencies-all.jar">
			<!--<zipgroupfileset dir="lib">
				<include name="**/*.jar" />
			</zipgroupfileset>-->
		</jar>
		<jar destfile="${jar.dest.path}/${target.name}" filesetmanifest="mergewithoutmain">


			<fileset dir="target/classes">
				<exclude name="**/StartVantedWithAddon.*"/>
				<exclude name="**/.gitkeep"/>
			</fileset>
			<!-- Include sources -->
			<fileset dir="src/main/java">
				<!--<include name="**/*.java" />-->
				<include name="**/*.xml" />
			</fileset>
			<!-- Include resources -->
			<fileset dir="src/main/resources">
				<!--<include name="**/*.java" />-->
				<include name="**/*.xml" />
			</fileset>

			<!-- don't forget to include yours libs using this command -->
			<zipfileset excludes="META-INF/*.SF"
						src="${jar.dest.path}/dependencies-all.jar" />

		</jar>

		<delete file="${jar.dest.path}/dependencies-all.jar" />
	</target>

	<target name="compile">
		<mkdir dir="target/classes"/>
		<mkdir dir="target/jar"/>
		<javac srcdir="src/main/java" destdir="target/classes" includes="**/*.java" includeantruntime="false">
			<exclude name="**/StartVantedWithAddon.java"/>
			<classpath>
				<!-- Include VANTED -->
				<fileset dir="../VANTED/target/jar">
					<include name="**/*.jar" />
				</fileset>
				<pathelement path="target/classes" />

			</classpath>
		</javac>
	</target>
</project>
